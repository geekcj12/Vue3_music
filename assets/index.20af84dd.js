import{u as e,r as t,a as s,o as n,c as a,b as l,w as o,d as r,v as i,e as c,f as u,t as d,g as p,h as m,i as g,j as v,k as h,F as y,l as f,m as L,T as E,n as T,p as _,q as b,s as S,x as w,y as k,z as P}from"./vendor.76c7ad6e.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(s){const n=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((s,l)=>{const o=new URL(e,n);if(self[t].moduleMap[o])return s(self[t].moduleMap[o]);const r=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){l(new Error(`Failed to import: ${e}`)),a(i)},onload(){s(self[t].moduleMap[o]),a(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("assets/");const x={name:"Header",setup(){const s=e();let n=t("");return{searchText:n,toSearch:async()=>{n.value&&s.push({path:"/search",query:{keywords:n.value}})}}}},V={class:"header"},M={class:"site-title"},R=u("冈另云音乐"),C=l("button",{type:"submit"},"搜索",-1);x.render=function(e,t,u,d,p,m){const g=s("router-link");return n(),a("div",V,[l("h2",M,[l(g,{to:"/"},{default:o((()=>[R])),_:1})]),l("form",{class:"search-form",onSubmit:t[2]||(t[2]=c(((...e)=>d.toSearch&&d.toSearch(...e)),["prevent"]))},[r(l("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>d.searchText=e),type:"text",class:"search-input",placeholder:"你想搜什么？"},null,512),[[i,d.searchText]]),C],32)])};const O={name:"ProgressBar",props:{progress:{type:Number,default:0},loaded:{type:Number,default:0},disabled:{type:Boolean,default:!0}},setup(e,s){const n=t(null),a=t(null);let{progress:l,loaded:o,disabled:r}=d(e),i=t(l.value),c=t(o.value);const{emit:u}=s,g=/mobile/i.test(window.navigator.userAgent),v={dragStart:g?"touchstart":"mousedown",dragMove:g?"touchmove":"mousemove",dragEnd:g?"touchend":"mouseup"};p((()=>{h()}));const h=()=>{let e=!1;m([l,o],(t=>{const[s,n]=t;e||(i.value=s),c.value=n})),n.value.addEventListener("click",(e=>{r.value||(i.value=Math.round(e.x/n.value.offsetWidth*1e4)/100,u("changeTime",i.value))})),a.value.addEventListener(v.dragStart,(()=>{r.value||(e=!0),document.addEventListener(v.dragMove,(t=>{if(t.preventDefault(),e){const e=g?t.changedTouches[0].clientX:t.clientX;i.value=Math.round(e/n.value.offsetWidth*1e4)/100}})),document.addEventListener(v.dragEnd,(()=>{e&&u("changeTime",i.value),e=!1}))}))};return{progressBar:n,thumb:a,progressWidth:i,loadedWidth:c}}},U={class:"progress-bar",ref:"progressBar"},N={class:"thumb",ref:"thumb"};O.render=function(e,t,s,o,r,i){return n(),a("div",U,[l("div",{class:"played",style:{width:`${o.progressWidth}%`}},[l("div",N,null,512)],4),l("div",{class:"loaded",style:{width:`${o.loadedWidth}%`}},null,4)],512)};const j={name:"PlayList",props:{show:{type:Boolean,default:!1}},setup(e,t){const s=g(),{show:n}=d(e),a=v((()=>s.state.player.list)),{emit:l}=t;return m(n,(e=>{document.body.style.overflow=e?"hidden":"visible"})),{playList:a,playSong:e=>{s.dispatch("player/playSong",e)},removeSong:e=>{s.dispatch("player/removeSong",e)},closeList:()=>{l("closeList",!1)}}}},D={class:"play-list"},A={key:0,class:"song-list"},$={class:"song-item-main"},B={class:"title"},I={class:"author"},W={key:1,class:"none"};j.render=function(e,t,s,i,u,d){return n(),a("div",null,[r(l("div",{id:"mask",onClick:t[1]||(t[1]=(...e)=>i.closeList&&i.closeList(...e))},null,512),[[h,s.show]]),l(E,{name:"slide-right"},{default:o((()=>[r(l("div",D,[i.playList.length>0?(n(),a("ul",A,[(n(!0),a(y,null,f(i.playList,((e,t)=>(n(),a("li",{key:e.title,onClick:e=>i.playSong(t),class:"song-item"},[l("div",$,[l("span",B,L(e.title),1),l("span",I,L(e.author),1)]),l("button",{class:"iconfont icon-remove",onClick:c((e=>i.removeSong(t)),["stop"])},null,8,["onClick"])],8,["onClick"])))),128))])):(n(),a("div",W,"暂无歌曲"))],512),[[h,s.show]])])),_:1})])};const F={name:"Volume",props:{modelValue:{type:Number,default:0}},setup(e,s){const{modelValue:n}=d(e),{emit:a}=s,l=t(null);let o=t(n.value);const r=v((()=>0===n.value)),i=e=>{a("update:modelValue",e)};return p((()=>{l.value.addEventListener("click",(e=>{const t=Math.ceil(e.offsetX/l.value.offsetWidth*100)/100;i(t)}))})),{volumeBar:l,lastVolumeValue:o,isMute:r,toggleMute:()=>{r.value?i(o.value):(o.value=n.value,i(0))},updateValue:i}}},G={class:"volume"},X={class:"volume-bar",ref:"volumeBar"};F.render=function(e,t,s,o,r,i){return n(),a("div",G,[l("button",{class:["iconfont",[o.isMute?"icon-VolumeOff":"icon-VolumeUp"]],onClick:t[1]||(t[1]=(...e)=>o.toggleMute&&o.toggleMute(...e))},null,2),l("div",X,[l("div",{class:"volume-current",style:{width:100*s.modelValue+"%"}},null,4)],512)])};const q=T.create({baseURL:"https://www.hsslive.cn/xcx/",timeout:5e3,headers:{"content-type":"application-json"}});q.interceptors.request.use((e=>e),(e=>(console.log(e),Promise.reject(e)))),q.interceptors.response.use((e=>e.status>=200?e.data:e),(e=>(console.log(e),e.response.status,Promise.reject(e))));const H={name:"Lrc",props:{lrcUrl:{type:String,default:""},currentTime:{type:Number,default:0}},setup(e){const{lrcUrl:s,currentTime:n}=d(e),a=t([]),l=t("");let o=0;m(s,((e,t)=>{e!==t&&(o=0,l.value="",a.value=[],r(e))})),m(n,((e,t)=>{if(a.value.length){if(e>t)for(let t=o;t<a.value.length;t++)e>=a.value[t][0]&&(o=t);else for(let t=o;t>=0;t--){if(0===t){o=t;break}if(e>=a.value[t][0]){o=t;break}}l.value=a.value[o][1]}}));const r=async e=>{try{const t=await q.get(e);a.value=(e=>{if(e){const t=(e=e.replace(/([^\]^\n])\[/g,((e,t)=>t+"\n["))).split("\n");let s=[];const n=t.length;for(let e=0;e<n;e++){const n=t[e].match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),a=t[e].replace(/.*\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g,"").replace(/<(\d{2}):(\d{2})(\.(\d{2,3}))?>/g,"").replace(/^\s+|\s+$/g,"");if(n){const e=n.length;for(let t=0;t<e;t++){const e=/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/.exec(n[t]),l=60*e[1]+parseInt(e[2])+(e[4]?parseInt(e[4])/(2===(e[4]+"").length?100:1e3):0);s.push([l,a])}}}return s=s.filter((e=>e[1])),s.sort(((e,t)=>e[0]-t[0])),s}return[]})(t)}catch(t){console.error(t)}};return{currentLrc:l,lrcArray:a}}},Y={class:"lrc"};H.render=function(e,t,s,o,r,i){return n(),a("div",Y,[l("p",null,L(o.currentLrc),1)])};const z={name:"Player",components:{ProgressBar:O,Volume:F,Lrc:H,PlayList:j},setup(){const e=g(),s=t(!1),n=t(0),a=t(0),l=t(!1),o=t(.5),r=t(null),i=t(0),c=t(0),u=v((()=>e.state.player.current)),d=v((()=>0===Object.keys(u.value).length));let h=null;p((()=>{h=new Audio,h.volume=o.value,h.addEventListener("canplay",(()=>{h.play(),c.value=h.duration,s.value=!0})),h.addEventListener("timeupdate",(()=>{h.buffered.length&&(n.value=Math.round(h.currentTime/h.duration*1e4)/100,a.value=Math.round(h.buffered.end(0)/h.duration*1e4)/100,i.value=h.currentTime)})),h.addEventListener("play",(()=>{s.value=!0})),h.addEventListener("pause",(()=>{s.value=!1})),h.addEventListener("abort",(()=>{console.log("abort")})),h.addEventListener("ended",(()=>{h.pause(),s.value=!1,e.dispatch("player/nextSong")}))})),m(u,(e=>{h.src=e.url})),m(o,(e=>{h.volume=e}));return{playing:s,progress:n,loaded:a,song:u,showList:l,pic:r,volume:o,currentTime:i,totalTime:c,disabled:d,toggle:()=>{d.value||(h.paused?h.play():h.pause(),s.value=!s.value)},changeTime:e=>{h.currentTime=Math.ceil(h.duration*(e/100))},nextSong:()=>{e.dispatch("player/nextSong")},toggleList:()=>{l.value=!l.value},closeList:e=>{l.value=e},handleTime:e=>{const t=Math.floor(e/60);return`${t}:${Math.floor(e)-60*t}`}}}},J={class:"player"},K={class:"current-time"},Q={class:"total-time"},Z={class:"player-main"},ee={key:0,class:"song-info"},te={key:1,class:"pic"},se={class:"title"},ne={class:"control"};z.render=function(e,t,o,r,i,c){const u=s("ProgressBar"),d=s("Lrc"),p=s("Volume"),m=s("PlayList");return n(),a("div",J,[l(u,{progress:r.progress,loaded:r.loaded,disabled:r.disabled,onChangeTime:r.changeTime},null,8,["progress","loaded","disabled","onChangeTime"]),l("span",K,L(r.handleTime(r.currentTime)),1),l("span",Q,L(r.handleTime(r.totalTime)),1),l("div",Z,[r.song?(n(),a("div",ee,[r.song.pic?(n(),a("img",{key:0,src:r.song.pic,ref:"pic",class:["pic",{active:r.playing}]},null,10,["src"])):(n(),a("div",te)),l("h3",se,L(r.song.title),1)])):_("",!0),l(d,{lrcUrl:r.song.lrc,currentTime:r.currentTime,class:"lrc"},null,8,["lrcUrl","currentTime"]),l("div",ne,[l(p,{modelValue:r.volume,"onUpdate:modelValue":t[1]||(t[1]=e=>r.volume=e)},null,8,["modelValue"]),l("button",{class:["iconfont",[r.playing?"icon-pause":"icon-play"]],onClick:t[2]||(t[2]=(...e)=>r.toggle&&r.toggle(...e))},null,2),l("button",{class:"iconfont icon-next",onClick:t[3]||(t[3]=(...e)=>r.nextSong&&r.nextSong(...e))}),l("button",{class:"iconfont icon-more-line",onClick:t[4]||(t[4]=(...e)=>r.toggleList&&r.toggleList(...e))})])]),l(m,{show:r.showList,onCloseList:r.closeList},null,8,["show","onCloseList"])])};const ae={name:"Footer",components:{Player:z}},le={class:"footer"};ae.render=function(e,t,o,r,i,c){const u=s("Player");return n(),a("div",le,[l(u)])};const oe={name:"Layout",components:{Header:x,Footer:ae}},re={class:"layout"},ie={class:"main"};oe.render=function(e,t,o,r,i,c){const u=s("Header"),d=s("Footer");return n(),a("div",re,[l(u),l("div",ie,[b(e.$slots,"default")]),l(d)])};const ce={name:"App",components:{Layout:oe},setup(){const e=g(),t=v((()=>e.state.player.list));return p((()=>{})),{playList:t}}};let ue;ce.render=function(e,t,r,i,c,u){const d=s("router-view"),p=s("Layout");return n(),a(p,null,{default:o((()=>[l(d)])),_:1})};const de={},pe=function(e,t){if(!t)return e();if(void 0===ue){const e=document.createElement("link").relList;ue=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in de)return;de[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":ue,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))},me=[{name:"Home",path:"/",component:()=>pe((()=>__import__("./index.b0b202a4.js")),["./assets/index.b0b202a4.js","./assets/index.43e090b6.css","./assets/vendor.76c7ad6e.js","./assets/PlaySong.2bd0afd6.js"])},{name:"Search",path:"/search",component:()=>pe((()=>__import__("./Search.d0284f02.js")),["./assets/Search.d0284f02.js","./assets/Search.ea686428.css","./assets/vendor.76c7ad6e.js"])},{name:"PlayListDetail",path:"/playlist/detail/:id",component:()=>pe((()=>__import__("./PlayListDetail.4a48af18.js")),["./assets/PlayListDetail.4a48af18.js","./assets/PlayListDetail.e78770f1.css","./assets/vendor.76c7ad6e.js","./assets/playlist.70d3d8e6.js","./assets/PlaySong.2bd0afd6.js"])},{name:"ProgramDetail",path:"/program/detail/:id",component:()=>pe((()=>__import__("./ProgramDetail.af9b0211.js")),["./assets/ProgramDetail.af9b0211.js","./assets/PlayListDetail.e78770f1.css","./assets/vendor.76c7ad6e.js","./assets/playlist.70d3d8e6.js"])},{name:"Login",path:"/login",component:()=>pe((()=>__import__("./Login.2177bb7a.js")),["./assets/Login.2177bb7a.js","./assets/vendor.76c7ad6e.js"])}],ge=S({history:w(),routes:me}),ve={playListLength:e=>e.list.length},he={SET_PLAYLIST(e,t){e.list=t},SET_CURRENT(e,t){e.index=t,e.current=e.list[e.index]},SET_NEXT_SONG(e){1!==e.list.length&&(e.index<ve.playListLength(e)-1?e.current=e.list[e.index+=1]:e.index===ve.playListLength(e)-1&&he.SET_CURRENT(e,0))},ADD_SONG(e,t){e.list.push(t),he.SET_CURRENT(e,e.list.length-1)},REMOVE_SONG(e,t){ve.playListLength(e)>0&&e.list.splice(t,1)}};var ye=k({modules:{player:{namespaced:!0,state:{list:[],current:{},index:-1,loop:""},getters:ve,actions:{async getPlayList({commit:e}){try{const t=await q.get("/api/songs");200===t.code&&e("SET_PLAYLIST",t.data)}catch(t){console.log(t)}},playSong({commit:e},t){e("SET_CURRENT",t)},nextSong({commit:e}){e("SET_NEXT_SONG")},async addSong({commit:e},t){try{const s=await(e=>q.get("https://api.i-meto.com/meting/api",{params:{server:"netease",type:"song",id:e}}))(t);e("ADD_SONG",s[0])}catch(s){console.log(s)}},removeSong({commit:e},t){e("REMOVE_SONG",t)}},mutations:he}},strict:!1,plugins:[]});const fe=P(ce);fe.use(ge),fe.use(ye),fe.mount("#app");export{q as s};
